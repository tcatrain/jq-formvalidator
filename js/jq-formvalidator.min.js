(function(e){e.fn.formValidator=function(t){var n=e.extend({validateOnBlur:true,validateOnSubmit:true,validateOnKeyUp:false,validateOnKeyDown:false,validateOnFocus:false,keepValueIfWrong:true,onValidationSuccess:e(this)._onValidationSuccess,onValidationError:e(this)._onValidationError},t);e(this).filter("form").each(function(){e(this)._listen(n);e(this).find("input[jqfmv-validators]").each(function(){e(this)._listen(n)})})};e.fn.validate=function(){return e(this).is("form")?e(this)._validateForm():e(this)._validateInput()};e.fn._validateForm=function(){var t=[];var n=e(this).filter("form");if(n.length){e(n).each(function(){e(this).find("input[jqfmv-validators]").each(function(){t[e(this).attr("name")]=e(this)._validateInput()[e(this).attr("name")]})})}return t};e.fn._validateInput=function(){var t=[];var n=e(this).filter("input[jqfmv-validators]");n.each(function(){var n=e(this);var r=n.val();var i=n.attr("jqfmv-validators").split(",");t[n.attr("name")]=[];e(i).each(function(){var r=e.jqfmv.validators.validate(this,n);e(r).each(function(){t[n.attr("name")].push(this)})})});return t};e.fn._listen=function(t){var n=e(this).filter("form");if(e(this).is("form")){var r=e(this);if(t.validateOnBlur)r.on("submit",e.proxy(r._onFormEventTrigger,r,t))}else{var i=e(this);if(t.validateOnBlur)i.on("blur",e.proxy(i._onInputEventTrigger,i,t));if(t.validateOnKeyUp)i.on("keyup",e.proxy(i._onInputEventTrigger,i,t));if(t.validateOnKeyDown)i.on("keydown",e.proxy(i._onInputEventTrigger,i,t));if(t.validateOnFocus)i.on("focus",e.proxy(i._onInputEventTrigger,i,t))}};e.fn._onFormEventTrigger=function(t,n){n.preventDefault();var r=this.validate();this.find("input[jqfmv-validators]").each(function(){if(r[e(this).attr("name")].length>0)t.onValidationError(e(this),r[e(this).attr("name")]);else t.onValidationSuccess(e(this))})};e.fn._onInputEventTrigger=function(e,t){var n=this.validate();if(n[this.attr("name")].length)e.onValidationError(this,n[this.attr("name")]);else e.onValidationSuccess(this)};e.fn._onValidationSuccess=function(e){e.css("backgroundColor","green")};e.fn._onValidationError=function(e,t){e.css("backgroundColor","red")};e.jqfmv={validators:{_validators:{},add:function(e){this._validators[e.name]=e.handler},validate:function(t,n){return e.jqfmv.validators._validators[t](n.val(),this._against(t,n))},_against:function(e,t){return t.attr("jqfmv-against-"+e)},_core:{_lengthValidator:function(e,t){var n=[];var r=t.split(",");var i=r[0].length?window.parseInt(r[0]):null;var s=r[1].length?window.parseInt(r[1]):null;if(i!==null&&e.length<i){n.push("JQFMV_LENGTH_MIN_ERROR")}if(s!==null&&e.length>s){n.push("JQFMV_LENGTH_MAX_ERROR")}return n},_exprValidator:function(e,t){var n=[];if(e.match(t)===null)n.push("JQFMV_EXPR_MATCH_ERROR");return n}}}};e.jqfmv.validators.add({name:"length",handler:e.jqfmv.validators._core._lengthValidator});e.jqfmv.validators.add({name:"expr",handler:e.jqfmv.validators._core._exprValidator})})(jQuery)